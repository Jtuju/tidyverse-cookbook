<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>3 Tidy | The Tidyverse Cookbook</title>
  <meta name="description" content="How to solve common data science tasks with R’s Tidyverse">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="3 Tidy | The Tidyverse Cookbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="How to solve common data science tasks with R’s Tidyverse" />
  <meta name="github-repo" content="rstudio-education/tidyverse-cookbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Tidy | The Tidyverse Cookbook" />
  
  <meta name="twitter:description" content="How to solve common data science tasks with R’s Tidyverse" />
  

<meta name="author" content="Edited by Garrett Grolemund">


<meta name="date" content="2018-12-06">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="import.html">
<link rel="next" href="transform-tables.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Tidyverse Cookbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="how-to-use-this-book.html"><a href="how-to-use-this-book.html"><i class="fa fa-check"></i>How to use this book</a></li>
<li class="part"><span><b>I The Recipes</b></span></li>
<li class="chapter" data-level="1" data-path="program.html"><a href="program.html"><i class="fa fa-check"></i><b>1</b> Program</a></li>
<li class="chapter" data-level="2" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>2</b> Import</a></li>
<li class="chapter" data-level="3" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>3</b> Tidy</a></li>
<li class="chapter" data-level="4" data-path="transform-tables.html"><a href="transform-tables.html"><i class="fa fa-check"></i><b>4</b> Transform Tables</a></li>
<li class="chapter" data-level="5" data-path="transform-lists.html"><a href="transform-lists.html"><i class="fa fa-check"></i><b>5</b> Transform Lists</a></li>
<li class="chapter" data-level="6" data-path="transform-data-vectors.html"><a href="transform-data-vectors.html"><i class="fa fa-check"></i><b>6</b> Transform Data Vectors</a></li>
<li class="chapter" data-level="7" data-path="transform-strings.html"><a href="transform-strings.html"><i class="fa fa-check"></i><b>7</b> Transform Strings</a></li>
<li class="chapter" data-level="8" data-path="transform-factors.html"><a href="transform-factors.html"><i class="fa fa-check"></i><b>8</b> Transform Factors</a></li>
<li class="chapter" data-level="9" data-path="transform-dates-and-times.html"><a href="transform-dates-and-times.html"><i class="fa fa-check"></i><b>9</b> Transform Dates and Times</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Tidyverse Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy" class="section level1">
<h1><span class="header-section-number">3</span> Tidy</h1>
<hr />
<div class="col2">
<ol style="list-style-type: decimal">
<li><a href="tidy.html#create-a-tibble-manually">Create a tibble manually</a></li>
<li><a href="tidy.html#convert-a-data-frame-to-a-tibble">Convert a data frame to a tibble</a></li>
<li><a href="tidy.html#convert-a-tibble-to-a-data-frame">Convert a tibble to a data frame</a></li>
<li><a href="tidy.html#preview-the-contents-of-a-tibble">Preview the contents of a tibble</a></li>
<li><a href="tidy.html#inspect-every-cell-of-a-tibble">Inspect every cell of a tibble</a></li>
<li><a href="tidy.html#spread-a-pair-of-columns-into-a-field-of-cells">Spread a pair of columns into a field of cells</a></li>
<li><a href="tidy.html#gather-a-field-of-cells-into-a-pair-of-columns">Gather a field of cells into a pair of columns</a></li>
<li><a href="tidy.html#separate-a-column-into-new-columns">Separate a column into new columns</a></li>
<li><a href="tidy.html#unite-multiple-columns-into-a-single-column">Unite multiple columns into a single column</a></li>
</ol>
</div>
<hr />
<div id="what-you-should-know-before-you-begin-2" class="section level2 unnumbered">
<h2>What you should know before you begin</h2>

<div class="rmdcaution">
Data tidying refers to reshaping your data into a tidy data frame or <a href="how-to-use-this-book.html#tidy-data">tibble</a>. Data tidying is an important first step for your analysis because every tidyverse function will expect your data to be stored as <strong>Tidy Data</strong>.
</div>


<div class="rmdcaution">
<p>Tidy data is tabular data organized so that:</p>
<ol style="list-style-type: decimal">
<li>Each column contains a single variable</li>
<li>Each row contains a single observation
</div></li>
</ol>

<div class="rmdcaution">
The definition of tidy data depends on the definition of variable, which is <em>a quantity, quality, or property that you can measure</em>.
</div>


<div class="rmdcaution">
With enough mental flexibility, you can consider anything to be a variable (and use anything as a variable). However, some variables will be more useful than others for any specific task. In general, if you can formulate your task as an equation (math or code that contains an equals sign), the most useful variables will be the objects in the equation.
</div>


<div class="rmdcaution">
Tidy data is not an arbitrary requirement of the tidyverse; it is the ideal data format for doing data science with R. Tidy data makes it easy to extract every value of a variable to build a plot or to compute a summary statistic. Tidy data also makes it easy to compute new variables; when your data is tidy, you can rely on R’s rowwise operations to maintain the integrity of your observations. Moreover, R can directly manipulate tidy data with R’s fast, built-in vectorised observations, which lets your code run as fast as possible.
</div>

</div>
<div id="create-a-tibble-manually" class="section level2">
<h2><span class="header-section-number">3.1</span> Create a tibble manually</h2>
<p>You want to create a tibble from scratch by typing in the contents of the tibble.</p>
<div id="solution-11" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tribble</span>(<span class="op">~</span>number, <span class="op">~</span>letter,   <span class="op">~</span>greek,
              <span class="dv">1</span>,     <span class="st">&quot;a&quot;</span>,  <span class="st">&quot;alpha&quot;</span>,
              <span class="dv">2</span>,     <span class="st">&quot;b&quot;</span>,   <span class="st">&quot;beta&quot;</span>,
              <span class="dv">3</span>,     <span class="st">&quot;c&quot;</span>,  <span class="st">&quot;gamma&quot;</span>)</code></pre>
<pre><code>## # A tibble: 3 x 3
##   number letter greek
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;
## 1      1 a      alpha
## 2      2 b      beta 
## 3      3 c      gamma</code></pre>
</div>
<div id="discussion-11" class="section level4 unnumbered">
<h4>Discussion</h4>
<p><code>tribble()</code> creates a tibble while generating a preview of the result in your code. To use <code>tribble()</code>, list each column name preceded by a <code>~</code>, then list the values of the tribble in a rowwise fashion. If you take care to align your columns, the transposed syntax of <code>tribble()</code> becomes a preview of the table.</p>
<p>You can also create a tibble with <code>tibble()</code>, whose syntax mirrors <code>data.frame()</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">number =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), 
       <span class="dt">letter =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),
       <span class="dt">greek =</span> <span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;gamma&quot;</span>))</code></pre>
</div>
</div>
<div id="convert-a-data-frame-to-a-tibble" class="section level2">
<h2><span class="header-section-number">3.2</span> Convert a data frame to a tibble</h2>
<p>You want to convert a data frame to a tibble.</p>
<div id="solution-12" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as_tibble</span>(iris)</code></pre>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1          5.1         3.5          1.4         0.2 setosa 
##  2          4.9         3            1.4         0.2 setosa 
##  3          4.7         3.2          1.3         0.2 setosa 
##  4          4.6         3.1          1.5         0.2 setosa 
##  5          5           3.6          1.4         0.2 setosa 
##  6          5.4         3.9          1.7         0.4 setosa 
##  7          4.6         3.4          1.4         0.3 setosa 
##  8          5           3.4          1.5         0.2 setosa 
##  9          4.4         2.9          1.4         0.2 setosa 
## 10          4.9         3.1          1.5         0.1 setosa 
## # ... with 140 more rows</code></pre>
</div>
</div>
<div id="convert-a-tibble-to-a-data-frame" class="section level2">
<h2><span class="header-section-number">3.3</span> Convert a tibble to a data frame</h2>
<p>You want to convert a tibble to a data frame.</p>
<div id="solution-13" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.data.frame</span>(table1)</code></pre>
<pre><code>##       country year  cases population
## 1 Afghanistan 1999    745   19987071
## 2 Afghanistan 2000   2666   20595360
## 3      Brazil 1999  37737  172006362
## 4      Brazil 2000  80488  174504898
## 5       China 1999 212258 1272915272
## 6       China 2000 213766 1280428583</code></pre>
</div>
<div id="discussion-12" class="section level4 unnumbered">
<h4>Discussion</h4>

<div class="rmdcaution">
Be careful to use <code>as.data.frame()</code> and not <code>as_data_frame()</code>, which is an alias for <code>as_tibble()</code>.
</div>

</div>
</div>
<div id="preview-the-contents-of-a-tibble" class="section level2">
<h2><span class="header-section-number">3.4</span> Preview the contents of a tibble</h2>
<p>You want to get an idea of what variables and values are stored in a tibble.</p>
<div id="solution-14" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r">storms</code></pre>
<pre><code>## # A tibble: 10,010 x 13
##    name   year month   day  hour   lat  long status category  wind pressure
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;ord&gt;    &lt;int&gt;    &lt;int&gt;
##  1 Amy    1975     6    27     0  27.5 -79   tropi… -1          25     1013
##  2 Amy    1975     6    27     6  28.5 -79   tropi… -1          25     1013
##  3 Amy    1975     6    27    12  29.5 -79   tropi… -1          25     1013
##  4 Amy    1975     6    27    18  30.5 -79   tropi… -1          25     1013
##  5 Amy    1975     6    28     0  31.5 -78.8 tropi… -1          25     1012
##  6 Amy    1975     6    28     6  32.4 -78.7 tropi… -1          25     1012
##  7 Amy    1975     6    28    12  33.3 -78   tropi… -1          25     1011
##  8 Amy    1975     6    28    18  34   -77   tropi… -1          30     1006
##  9 Amy    1975     6    29     0  34.4 -75.8 tropi… 0           35     1004
## 10 Amy    1975     6    29     6  34   -74.8 tropi… 0           40     1002
## # ... with 10,000 more rows, and 2 more variables: ts_diameter &lt;dbl&gt;,
## #   hu_diameter &lt;dbl&gt;</code></pre>
</div>
<div id="discussion-13" class="section level4 unnumbered">
<h4>Discussion</h4>
<p>When you call a tibble directly, R will display enough information to give you a quick sense of the contents of the tibble. This includes:</p>
<ol style="list-style-type: decimal">
<li>the dimensions of the tibble</li>
<li>the column names and types</li>
<li>as many cells of the tibble as will fit comfortably in your console window</li>
</ol>
</div>
</div>
<div id="inspect-every-cell-of-a-tibble" class="section level2">
<h2><span class="header-section-number">3.5</span> Inspect every cell of a tibble</h2>
<p>You want to see which values are stored in a tibble.</p>
<div id="solution-15" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(storms)</code></pre>
</div>
<div id="discussion-14" class="section level4 unnumbered">
<h4>Discussion</h4>
<p><code>View()</code> (with a capital V) opens the tibble in R’s data viewer, which will let you scroll to every cell in the tibble.</p>
</div>
</div>
<div id="spread-a-pair-of-columns-into-a-field-of-cells" class="section level2">
<h2><span class="header-section-number">3.6</span> Spread a pair of columns into a field of cells</h2>
<p>You want to <strong>pivot</strong>, <strong>convert long data to wide</strong>, or move variable names out of the cells and into the column names. These are different ways of describing the same thing.</p>
<p>For example, <code>table2</code> contains <code>type</code>, which is a column that repeats the variable names <code>case</code> and <code>population</code>. To make <code>table2</code> tidy, you must move <code>case</code> and <code>population</code> values into their own columns.</p>
<pre class="sourceCode r"><code class="sourceCode r">table2</code></pre>
<pre><code>## # A tibble: 12 x 4
##    country      year type            count
##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
##  1 Afghanistan  1999 cases             745
##  2 Afghanistan  1999 population   19987071
##  3 Afghanistan  2000 cases            2666
##  4 Afghanistan  2000 population   20595360
##  5 Brazil       1999 cases           37737
##  6 Brazil       1999 population  172006362
##  7 Brazil       2000 cases           80488
##  8 Brazil       2000 population  174504898
##  9 China        1999 cases          212258
## 10 China        1999 population 1272915272
## 11 China        2000 cases          213766
## 12 China        2000 population 1280428583</code></pre>
<div id="solution-16" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r">table2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> type, <span class="dt">value =</span> count)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
</div>
<div id="discussion-15" class="section level4 unnumbered">
<h4>Discussion</h4>
<p>To use <code>spread()</code>, assign the column that contains variable names to <code>key</code>. Assign the column that contains the values that are associated with those names to <code>value</code>. <code>spread()</code> will:</p>
<ol style="list-style-type: decimal">
<li>Make a copy of the original table</li>
<li>Remove the <code>key</code> and <code>value</code> columns from the copy</li>
<li>Remove every duplicate row in the data set that remains</li>
<li>Insert a new column for each unique variable name in the <code>key</code> column</li>
<li>Fill the new columns with the values of the <code>value</code> column in a way that preserves each relationship between values in the original data set</li>
</ol>
<p>Each new column created by <code>spread()</code> will inherit the data type of the <code>value</code> column. If you would like <code>spread()</code> to convert each new column to the most sensible data type given its final contents, add the argument <code>convert = TRUE</code>.</p>
</div>
</div>
<div id="gather-a-field-of-cells-into-a-pair-of-columns" class="section level2">
<h2><span class="header-section-number">3.7</span> Gather a field of cells into a pair of columns</h2>
<p>You want to <strong>convert wide data to long</strong>, reshape a <strong>two-by-two table</strong>, or move variable values out of the column names and into the cells. These are different ways of describing the same thing.</p>
<p>For example, <code>table4a</code> is a two-by-two table with the column names <code>1999</code> and <code>2000</code>. These names are values of a <code>year</code> variable. The field of cells in <code>table4a</code> contains counts of TB cases, which is another variable. To make <code>table4a</code> tidy, you need to move <code>year</code> and <code>cases</code> into their own columns.</p>
<pre class="sourceCode r"><code class="sourceCode r">table4a</code></pre>
<pre><code>## # A tibble: 3 x 3
##   country     `1999` `2000`
## * &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
## 1 Afghanistan    745   2666
## 2 Brazil       37737  80488
## 3 China       212258 213766</code></pre>
<div id="solution-17" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r">table4a <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;cases&quot;</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
## 1 Afghanistan 1999     745
## 2 Brazil      1999   37737
## 3 China       1999  212258
## 4 Afghanistan 2000    2666
## 5 Brazil      2000   80488
## 6 China       2000  213766</code></pre>
</div>
<div id="discussion-16" class="section level4 unnumbered">
<h4>Discussion</h4>
<p><code>gather()</code> is the inverse of <code>spread()</code>: <code>gather()</code> collapses a field of cells that spans several columns into two columns:</p>
<ol style="list-style-type: decimal">
<li>A column of former “keys”, which contains the column names of the former field</li>
<li>A column of former “values”, which contains the cell values of the former field</li>
</ol>
<p>To use <code>gather()</code>, pick names for the new <code>key</code> and <code>value</code> columns, and supply them as strings. Then identify the columns to gather into the new key and value columns. <code>gather()</code> will:</p>
<ol style="list-style-type: decimal">
<li>Create a copy of the original table</li>
<li>Remove the identified columns from the copy</li>
<li>Add a key column with the supplied name</li>
<li>Fill the key column with the column names of the removed columns, repeating rows as necessary so that each combination of row and removed column name appears once</li>
<li>Add a value column with the supplied name</li>
<li>Fill the value column with the values of the removed columns in a way that preserves each relationship between values and column names in the original data set</li>
</ol>
<p>You can identify the columns to remove by name, by index (number), by inverse index (negative number), or by any of the <a href="https://dplyr.tidyverse.org/reference/select.html#useful-functions"><code>select()</code> helpers</a>, which come in the dplyr package. So for example, the following commands will do the same thing as the solution above:</p>
<pre class="sourceCode r"><code class="sourceCode r">table4a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;cases&quot;</span>, <span class="st">`</span><span class="dt">&quot;1999&quot;, &quot;2000&quot;)</span>
<span class="dt">table4a %&gt;% gather(key = &quot;year&quot;, value = &quot;cases&quot;, -1)</span>
<span class="dt">table4a %&gt;% gather(key = &quot;year&quot;, value = &quot;cases&quot;, one_of(c(&quot;1999&quot;, &quot;2000&quot;)))</span></code></pre>
<p>By default, the new key column will contain character strings. If you would like <code>gather()</code> to convert the new key column to the most sensible data type given its final contents, add the argument <code>convert = TRUE</code>.</p>
</div>
</div>
<div id="separate-a-column-into-new-columns" class="section level2">
<h2><span class="header-section-number">3.8</span> Separate a column into new columns</h2>
<p>You want to split a single column into multiple columns by separating each cell in the column into a row of cells that each contain a separate portion of the value in the original cell.</p>
<p>For example, <code>table3</code> combines <code>cases</code> and <code>population</code> values in a single column named <code>rate</code>. To make <code>table3</code> tidy, you need to separate <code>rate</code> into two columns: one for the <code>cases</code> variable, one for the <code>population</code> variable.</p>
<pre class="sourceCode r"><code class="sourceCode r">table3</code></pre>
<pre><code>## # A tibble: 6 x 3
##   country      year rate             
## * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583</code></pre>
<div id="solution-18" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r">table3 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(<span class="dt">col =</span> rate, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="dt">convert =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
## * &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
</div>
<div id="discussion-17" class="section level4 unnumbered">
<h4>Discussion</h4>
<p>To use <code>separate()</code>, pass <code>col</code> the name of the column to split. Pass <code>into</code> a vector of names for the new columns that <code>col</code> will be split into. You should supply one name for each new column that you expect to appear in the result; a mismatch will imply that something went wrong. <code>separate()</code> will:</p>
<ol style="list-style-type: decimal">
<li>Create a copy of the original data set</li>
<li>Add a new column for each name in <code>into</code></li>
<li>Split each value of <code>col</code> into multiple values. To do this, <code>separate()</code> will locate the positions of a separator character in each value. <code>separate()</code> will then makes the segments that appear between the separators separate (sub)values.</li>
<li>Place the resulting (sub)values into the new columns in order, one (sub)value per column</li>
<li>Remove the <code>col</code> column</li>
</ol>
<p>Add the argument <code>remove = FALSE</code> to retain the <code>col</code> column in the final result.</p>
<p>By default, <code>separate()</code> will use each non-alpha-numeric character as a separator. To designate a specific separator character, pass a regular expression to <code>sep</code>. To split values into sequences that each have a specific number of characters, pass an integer vector to <code>sep</code>:</p>
<ul>
<li><code>sep = 1</code> will split each value between the first and second character.</li>
<li><code>sep = c(1, 3)</code> will split each value between the first and second character and then again between the third and fourth character.</li>
<li><code>sep = -1</code> will split each value between the last and second to last character.</li>
</ul>
<p>Each new column created by <code>separate()</code> will inherit the data type of the <code>col</code> column. If you would like <code>separate()</code> to convert each new column to the most sensible data type given its final contents, add the argument <code>convert = TRUE</code>.</p>
</div>
</div>
<div id="unite-multiple-columns-into-a-single-column" class="section level2">
<h2><span class="header-section-number">3.9</span> Unite multiple columns into a single column</h2>
<p>You want to combine several columns into a single column by uniting their values across rows.</p>
<p>For example, <code>table5</code> splits the <code>year</code> variable across two columns: <code>century</code> and <code>year</code>. To make <code>table5</code> tidy, you need to unite <code>century</code> and <code>year</code> into a single column.</p>
<pre class="sourceCode r"><code class="sourceCode r">table5</code></pre>
<pre><code>## # A tibble: 6 x 4
##   country     century year  rate             
## * &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 19      99    745/19987071     
## 2 Afghanistan 20      00    2666/20595360    
## 3 Brazil      19      99    37737/172006362  
## 4 Brazil      20      00    80488/174504898  
## 5 China       19      99    212258/1272915272
## 6 China       20      00    213766/1280428583</code></pre>
<div id="solution-19" class="section level4 unnumbered">
<h4>Solution</h4>
<pre class="sourceCode r"><code class="sourceCode r">table5 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">unite</span>(<span class="dt">col =</span> <span class="st">&quot;year&quot;</span>, century, year, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   country     year  rate             
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 1999  745/19987071     
## 2 Afghanistan 2000  2666/20595360    
## 3 Brazil      1999  37737/172006362  
## 4 Brazil      2000  80488/174504898  
## 5 China       1999  212258/1272915272
## 6 China       2000  213766/1280428583</code></pre>
</div>
<div id="discussion-18" class="section level4 unnumbered">
<h4>Discussion</h4>
<p>To use <code>unite()</code>, give <code>col</code> a character string to use as the name of the new column to create. Then list the columns to combine, and give <code>sep</code> a separator character to use to paste together the values in the cells of each column. <code>unite()</code> will:</p>
<ol style="list-style-type: decimal">
<li>Paste together the values of the listed columns in vectorized (i.e. rowwise) fashion. <code>unite()</code> will place <code>sep</code> between each value during the paste process.</li>
<li>Append the result as a column named <code>col</code> to a copy of the original data set</li>
<li>Remove the listed columns. To retain the columns in the result, add the argument <code>remove = FALSE</code>.</li>
</ol>

<div class="rmdcaution">
If you do not suppy a <code>sep</code> value, <code>unite()</code> will use <code>_</code> as a separator character.
</div>


</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="import.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="transform-tables.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio-education/tidyverse-cookbook/edit/master/03-tidy.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
